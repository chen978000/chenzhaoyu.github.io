(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10012d7a"],{"175a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main_box"},[r("span",{staticClass:"title_span"},[e._v("新增工单")]),r("div",{staticClass:"content_box"},[r("Form",{ref:"mainForm",attrs:{model:e.form_data,rules:e.formRules,"label-position":"right","label-width":80}},[r("FormItem",{attrs:{label:"服务类型"}},[r("Select",{staticStyle:{width:"300px"},model:{value:e.form_data.serverType,callback:function(t){e.$set(e.form_data,"serverType",t)},expression:"form_data.serverType"}},e._l(e.typeList,function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),r("FormItem",{attrs:{label:"循环周期",prop:"circleTime"}},[r("Select",{staticClass:"date_select",style:{width:1===e.form_data.circleTime?"150px":"300px"},model:{value:e.form_data.circleTime,callback:function(t){e.$set(e.form_data,"circleTime",t)},expression:"form_data.circleTime"}},e._l(e.circleList,function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1===e.form_data.circleTime?r("InputNumber",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{min:1,value:e.form_data.circleTime,placeholder:"请输入自定义天数"}}):e._e(),1===e.form_data.circleTime?r("span",{staticStyle:{"margin-left":"5px"}},[e._v("天")]):e._e()],1),r("FormItem",{attrs:{label:"客户名称",prop:"companyId"}},[r("Select",{staticStyle:{width:"300px"},attrs:{filterable:""},on:{"on-change":e.changeCustomer},model:{value:e.form_data.companyId,callback:function(t){e.$set(e.form_data,"companyId",t)},expression:"form_data.companyId"}},e._l(e.customerList,function(t){return r("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.companyName))])}))],1),e.form_data.companyId?r("FormItem",{attrs:{label:"联系人",prop:"costomName"}},[r("Input",{staticStyle:{width:"300px"},attrs:{value:e.form_data.costomName}})],1):e._e(),e.form_data.companyId?r("FormItem",{attrs:{label:"联系电话",prop:"mobile"}},[r("Input",{staticStyle:{width:"300px"},attrs:{value:e.form_data.mobile}})],1):e._e(),e.form_data.companyId?r("FormItem",{attrs:{label:"设备名称",prop:"equipmentId"}},[r("Select",{staticStyle:{width:"300px"},attrs:{filterable:"","label-in-value":""},on:{"on-change":e.changeEquipment},model:{value:e.form_data.equipmentId,callback:function(t){e.$set(e.form_data,"equipmentId",t)},expression:"form_data.equipmentId"}},e._l(e.equipmentList,function(t){return r("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.equipmentName))])}))],1):e._e(),r("FormItem",{attrs:{label:"派工",prop:"userId"}},[r("Select",{staticStyle:{width:"300px"},on:{"on-change":e.changeTechUser},model:{value:e.form_data.userId,callback:function(t){e.$set(e.form_data,"userId",t)},expression:"form_data.userId"}},e._l(e.techUserList,function(t){return r("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),r("FormItem",{attrs:{label:"备注"}},[r("Input",{staticStyle:{width:"300px","font-size":"10px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"添加备注"},model:{value:e.form_data.serverNote,callback:function(t){e.$set(e.form_data,"serverNote",t)},expression:"form_data.serverNote"}})],1)],1),r("Button",{staticStyle:{margin:"20px"},attrs:{type:"primary"},on:{click:e.saveOrder}},[e._v("保存")])],1)])},s=[],n=(r("7f7f"),r("96cf"),r("1da1")),i={name:"add_auto_order",data:function(){return{form_data:{serverType:"",circleTime:null,order_time:"",serverStarttime:"",companyName:"",companyId:"",costomName:"",address:"",mobile:"",equipmentId:"",equipmentName:"",dealType:"0",serverNote:"",handler:"",userId:"",userName:""},equipmentList:[],formRules:{circleTime:[{required:!0,message:"请选择循环周期",trigger:"change",pattern:/.+/}],companyId:[{required:!0,message:"请选择客户",trigger:"blur",pattern:/.+/}],costomName:[{required:!0,message:"联系人不允许为空",trigger:"blur"}],mobile:[{required:!0,message:"联系电话不允许为空",trigger:"blur"}],equipmentId:[{required:!0,message:"请选择设备",trigger:"change"}],userId:[{required:!0,message:"请选择派工人员",trigger:"change"}]},options1:{shortcuts:[{text:"当前时间",value:function(){return new Date}},{text:"2小时前",value:function(){var e=new Date;return e.setTime(e.getTime()-72e5),e}},{text:"24小时前",value:function(){var e=new Date;return e.setTime(e.getTime()-864e5),e}}],disabledDate:function(e){return e&&e.valueOf()>Date.now()}},typeList:[],circleList:[{label:"30天",value:30},{label:"90天",value:90},{label:"180天",value:180},{label:"360天",value:360},{label:"自定义",value:1}],techUserList:[],customerList:[],dmlb:"",modalShow:!0}},mounted:function(){this.getCustomer(),this.getTechUserList(),this.getServerType()},watch:{"form_data.companyId":{handler:function(e){this.getDevice(e)},deep:!0}},methods:{getServerType:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={dmlb:"serverType"},e.next=3,this.$service.order.getServer(t);case 3:if(r=e.sent,a=r.err,s=r.data,!a){e.next=9;break}return this.$Message.error(a.message),e.abrupt("return");case 9:this.typeList=s.data.map(function(e){return{value:e.dmz,label:e.dmsm1}});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),changeEquipment:function(e){this.form_data.equipmentName=e.label},saveOrder:function(){var e=this;this.$refs["mainForm"].validate(function(t){t?e.addOrder():e.$Message.error("请按要求输入")})},addOrder:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={serverType:this.form_data.serverType,cycle:this.form_data.circleTime,costomName:this.form_data.costomName,companyName:this.form_data.companyName,companyId:this.form_data.companyId,mobile:this.form_data.mobile,address:this.form_data.address,equipmentName:this.form_data.equipmentName,equipmentId:this.form_data.equipmentId,serverNote:this.form_data.serverNote,userId:this.form_data.userId,userName:this.form_data.userName,state:1},e.next=3,this.$service.autoOrder.add(t);case 3:if(r=e.sent,a=r.err,s=r.data,!a){e.next=9;break}return this.$Message.error(a.message),e.abrupt("return");case 9:this.$Message.success(s.message),this.$router.push({name:"auto_order"});case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getCustomer:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.customer.getListAll();case 2:if(t=e.sent,r=t.err,a=t.data,!r){e.next=8;break}return this.$Message.error(r.message),e.abrupt("return");case 8:this.customerList=a.data;case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),changeCustomer:function(e){var t=this;this.customerList.map(function(r){r.id===e&&(t.form_data.companyName=r.companyName,t.form_data.costomName=r.costomName,t.form_data.mobile=r.mobile)}),this.form_data.equipmentId=""},getDevice:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.device.getListAll({costomId:t});case 2:if(r=e.sent,a=r.err,s=r.data,!a){e.next=8;break}return this.$Message.error(a.message),e.abrupt("return");case 8:this.equipmentList=s.data;case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getTechUserList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.techUser.getList();case 2:if(t=e.sent,r=t.err,a=t.data,!r){e.next=8;break}return this.$Message.error(r.message),e.abrupt("return");case 8:this.techUserList=a.data;case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),changeTechUser:function(e){var t=this;this.techUserList.map(function(r){r.id===e&&(t.form_data.userName=r.name)})}}},o=i,m=(r("1a68"),r("2877")),c=Object(m["a"])(o,a,s,!1,null,"0a55d039",null);c.options.__file="add_auto_order.vue";t["default"]=c.exports},"1a68":function(e,t,r){"use strict";var a=r("baa7"),s=r.n(a);s.a},baa7:function(e,t,r){}}]);