(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-169475c9"],{"74e5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main_box"},[a("div",{staticClass:"top_box"}),a("div",{staticClass:"search_box"},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入关键词查询",search:""},on:{"on-search":e.getList},model:{value:e.filter_keyword,callback:function(t){e.filter_keyword=t},expression:"filter_keyword"}}),e.btnList.indexOf("btn_addSpare")>-1?a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goAddSpare}},[e._v("新增备件")]):e._e(),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",loading:e.exportLoading},on:{click:e.exportExcel}},[e._v("导出EXCEL")])],1),a("div",{staticStyle:{"margin-top":"20px"}},[a("Table",{attrs:{border:"",loading:e.loading,columns:e.columns,data:e.spare_list},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.row;t.index;return[-1!=e.btnList.indexOf("btn_getSpare")?a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.spareOut(r)}}},[e._v("领用")]):e._e(),-1!=e.btnList.indexOf("btn_inSpare")?a("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){e.spareIn(r)}}},[e._v("入库")]):e._e(),-1!=e.btnList.indexOf("btn_editSpare")?a("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"warning",size:"small"},on:{click:function(t){e.editSpare(r)}}},[e._v("编辑")]):e._e(),a("Poptip",{attrs:{confirm:"",title:"确定删除此备件"},on:{"on-ok":function(t){e.remove(r)}}},[-1!=e.btnList.indexOf("btn_deleteSpare")?a("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"error",size:"small"}},[e._v("删除")]):e._e()],1)]}}])}),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("Page",{attrs:{total:e.count,page:e.page,"page-size":e.page_size,"show-sizer":"","show-total":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1),a("Modal",{attrs:{"mask-closable":!1,title:"备件入库"},model:{value:e.spareIn_show,callback:function(t){e.spareIn_show=t},expression:"spareIn_show"}},[a("Form",{attrs:{model:e.spareIn_model,"label-width":80}},[a("FormItem",{attrs:{label:"备件名称"}},[a("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.spareIn_model.equipmentPartName,callback:function(t){e.$set(e.spareIn_model,"equipmentPartName",t)},expression:"spareIn_model.equipmentPartName"}})],1),a("FormItem",{attrs:{label:"备件说明"}},[a("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.spareIn_model.description,callback:function(t){e.$set(e.spareIn_model,"description",t)},expression:"spareIn_model.description"}})],1),a("FormItem",{attrs:{label:"入库数量"}},[a("InputNumber",{attrs:{min:1},model:{value:e.spareIn_model.amount,callback:function(t){e.$set(e.spareIn_model,"amount",t)},expression:"spareIn_model.amount"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hideSpareInModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.goSpareIn}},[e._v("确定")])],1)],1),a("Modal",{attrs:{"mask-closable":!1,title:"领用备件"},model:{value:e.spareOut_show,callback:function(t){e.spareOut_show=t},expression:"spareOut_show"}},[a("Form",{attrs:{model:e.spareOut_model,"label-width":80}},[a("FormItem",{attrs:{label:"备件名称"}},[a("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.spareOut_model.equipmentPartName,callback:function(t){e.$set(e.spareOut_model,"equipmentPartName",t)},expression:"spareOut_model.equipmentPartName"}})],1),a("FormItem",{attrs:{label:"备件说明"}},[a("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.spareOut_model.description,callback:function(t){e.$set(e.spareOut_model,"description",t)},expression:"spareOut_model.description"}})],1),a("FormItem",{attrs:{label:"领用数量"}},[a("InputNumber",{attrs:{min:1,max:e.spareOut_model.amount},model:{value:e.spareOut_model.out_amount,callback:function(t){e.$set(e.spareOut_model,"out_amount",t)},expression:"spareOut_model.out_amount"}})],1),a("FormItem",{attrs:{label:"领用说明"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"textarea",placeholder:"请说明用途/领用原因"},model:{value:e.spareOut_model.info,callback:function(t){e.$set(e.spareOut_model,"info",t)},expression:"spareOut_model.info"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hideSpareOutModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.goSpareOut}},[e._v("确定")])],1)],1),a("Modal",{attrs:{"mask-closable":!1,title:"编辑备件"},model:{value:e.spare_show,callback:function(t){e.spare_show=t},expression:"spare_show"}},[a("Form",{ref:"spareForm",attrs:{model:e.spare_model,rules:e.spare_rules,"label-width":80}},[a("FormItem",{attrs:{label:"备件名称",prop:"equipmentPartName"}},[a("Input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.spare_model.equipmentPartName,callback:function(t){e.$set(e.spare_model,"equipmentPartName",t)},expression:"spare_model.equipmentPartName"}})],1),a("FormItem",{attrs:{label:"备件说明",prop:"description"}},[a("Input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.spare_model.description,callback:function(t){e.$set(e.spare_model,"description",t)},expression:"spare_model.description"}})],1),a("FormItem",{attrs:{label:"当前数量"}},[a("InputNumber",{attrs:{min:0},model:{value:e.spare_model.amount,callback:function(t){e.$set(e.spare_model,"amount",t)},expression:"spare_model.amount"}})],1),a("FormItem",{attrs:{label:"备注"}},[a("Input",{staticStyle:{width:"200px","font-size":"10px"},attrs:{clearable:"",type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请描述出现的问题"},model:{value:e.spare_model.remark,callback:function(t){e.$set(e.spare_model,"remark",t)},expression:"spare_model.remark"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hideSpareModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.saveSpare}},[e._v("确定")])],1)],1)],1)},s=[],n=a("be94"),i=(a("96cf"),a("1da1")),o=a("0a21"),l={name:"spare_list",data:function(){return{filter_keyword:"",spare_show:!1,spareIn_show:!1,spareOut_show:!1,count:0,page:1,page_size:10,spareIn_model:{},spareOut_model:{},spare_model:{},spare_rules:{equipmentPartName:[{required:!0,message:"备件名称不允许为空",trigger:"blur"}],description:[{required:!0,message:"备件说明不允许为空",trigger:"blur"}]},columns:[{title:"备件名称",key:"equipmentPartName",align:"center"},{title:"备件说明",key:"description",align:"center"},{title:"当前数量",key:"amount",align:"center",width:120},{title:"备注",key:"remark",align:"center"},{title:"操作",slot:"action",width:230}],btnList:[],spare_list:[],loading:!1,exportLoading:!1}},mounted:function(){this.getList()},methods:{getList:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={search:this.filter_keyword,num:this.page,size:this.page_size},this.loading=!0,e.next=4,this.$service.spare.getList(t);case 4:if(a=e.sent,r=a.err,s=a.data,this.loading=!1,!r){e.next=11;break}return this.$Message.error(r.message),e.abrupt("return");case 11:this.spare_list=s.data.list,this.count=s.data.count,this.btnList=sessionStorage.getItem("btnList");case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),saveSpare:function(){var e=this;this.$refs["spareForm"].validate(function(t){t?e.addSpare():e.$Message.error("请按要求输入")})},addSpare:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={id:this.spare_model.id,equipmentPartName:this.spare_model.edit_equipmentPartName,description:this.spare_model.edit_description,amount:this.spare_model.edit_amount,remark:this.spare_model.edit_remark},e.next=3,this.$service.spare.updateList(t);case 3:if(a=e.sent,r=a.err,s=a.data,!r){e.next=9;break}return this.$Message.error(r.message),e.abrupt("return");case 9:this.$Message.success(s.message),this.spare_show=!1;case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),spareIn:function(e){this.spareIn_show=!0,this.spareIn_model=Object(n["a"])({},e,{amount:1})},spareOut:function(e){0!=e.amount?(this.spareOut_show=!0,this.spareOut_model=Object(n["a"])({},e,{out_amount:1,info:""})):this.$Message.error("抱歉，备件库存不足，无法领用")},goAddSpare:function(){this.$router.push({path:"/spare/add_spare"})},editSpare:function(e){this.spare_show=!0,this.spare_model=Object(n["a"])({},e,{edit_equipmentPartName:e.equipmentPartName,edit_description:e.description,edit_amount:e.amount,edit_remark:e.remark})},hideSpareModal:function(){this.spare_show=!1,this.clearModal()},hideSpareInModal:function(){this.spareIn_show=!1,this.clearInModal()},hideSpareOutModal:function(){this.spareOut_show=!1,this.clearOutModal()},clearModal:function(){this.spare_model={}},clearInModal:function(){this.spareIn_model={}},clearOutModal:function(){this.spareOut_model={}},remove:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.spare.deleteSpare(t.id);case 2:if(a=e.sent,r=a.err,a.data,!r){e.next=8;break}return this.$Message.error(r.message),e.abrupt("return");case 8:this.getList();case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),goSpareIn:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.spareIn_model.amount&&" "!=this.spareIn_model.amount&&0!=this.spareIn_model.amount){e.next=3;break}return this.$Message.error("入库数量至少1件哦"),e.abrupt("return");case 3:return t={id:this.spareIn_model.id,amount:this.spareIn_model.amount},e.next=6,this.$service.spare.addSpareIn(t);case 6:if(a=e.sent,r=a.err,s=a.data,!r){e.next=12;break}return this.$Message.error(r.message),e.abrupt("return");case 12:this.$Message.success(s.message),this.$router.push({name:"spare_in_list"});case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),goSpareOut:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.spareOut_model.amount&&" "!=this.spareOut_model.amount&&0!=this.spareOut_model.amount){e.next=3;break}return this.$Message.error("领用数量至少1件哦"),e.abrupt("return");case 3:if(this.spareOut_model.info&&" "!=this.spareOut_model.info){e.next=6;break}return this.$Message.error("请输入领用说明"),e.abrupt("return");case 6:return t={id:this.spareOut_model.id,amount:this.spareOut_model.out_amount},e.next=9,this.$service.spare.addSpareOut(t);case 9:if(a=e.sent,r=a.err,s=a.data,!r){e.next=15;break}return this.$Message.error(r.message),e.abrupt("return");case 15:this.$Message.success(s.message),this.$router.push({name:"spare_out_list"});case 17:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),changePage:function(e){this.page=e,this.getList()},changePageSize:function(e){this.page=1,this.page_size=e,this.getList()},exportExcel:function(){if(this.spare_list.length){this.exportLoading=!0;var e=this.columns.map(function(e){if(e.key)return e.title}).filter(function(e){return void 0!=e}),t=this.columns.map(function(e){if(e.key)return e.key}).filter(function(e){return void 0!=e}),a=this.spare_list,r={title:e,key:t,data:a,autoWidth:!0,filename:"备件列表"};o["a"].export_array_to_excel(r),this.exportLoading=!1}else this.$Message.info("表格数据不能为空！")}}},p=l,u=(a("c2e4"),a("2877")),c=Object(u["a"])(p,r,s,!1,null,null,null);c.options.__file="spare_list.vue";t["default"]=c.exports},c2e4:function(e,t,a){"use strict";var r=a("d461"),s=a.n(r);s.a},d461:function(e,t,a){}}]);