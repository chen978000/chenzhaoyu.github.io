(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-95f57602"],{"2eb4":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main_box"},[r("div",{staticClass:"top_box"}),r("div",{staticClass:"search_box"},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入关键词查询",search:""},on:{"on-search":e.getList},model:{value:e.filter_keyword,callback:function(t){e.filter_keyword=t},expression:"filter_keyword"}}),r("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.showUserModal}},[e._v("新增用户")]),r("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",loading:e.exportLoading},on:{click:e.exportExcel}},[e._v("\n      导出EXCEL\n    ")])],1),r("div",{staticStyle:{"margin-top":"20px"}},[r("Table",{attrs:{border:"",loading:e.loading,columns:e.columns,data:e.user_list},scopedSlots:e._u([{key:"roleName",fn:function(t){var s=t.row;t.index;return e._l(s.rl,function(t){return r("span",{key:t.id,staticStyle:{"margin-right":"5px"}},[e._v(e._s(t.name))])})}},{key:"inServiceStatus",fn:function(t){var s=t.row;t.index;return[1==s.inServiceStatus?r("span",{staticStyle:{color:"#EE6542"}},[e._v("在职")]):e._e(),2==s.inServiceStatus?r("span",{staticStyle:{color:"#FFAD33"}},[e._v("离职")]):e._e()]}},{key:"action",fn:function(t){var s=t.row;t.index;return[r("Button",{attrs:{type:"warning",size:"small"},on:{click:function(t){e.editUser(s)}}},[e._v("编辑")]),1==s.inServiceStatus?r("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){e.Leave(s)}}},[e._v("离职")]):e._e(),r("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.resetPassword(s)}}},[e._v("重置密码")]),r("Poptip",{attrs:{confirm:"",title:"确定删除此用户"},on:{"on-ok":function(t){e.remove(s)}}},[r("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"error",size:"small"}},[e._v("删除")])],1)]}}])}),r("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[r("Page",{attrs:{total:e.count,page:e.page,"page-size":e.page_size,"show-sizer":"","show-total":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1),r("Modal",{attrs:{"mask-closable":!1,title:"新增用户"},model:{value:e.add_user_show,callback:function(t){e.add_user_show=t},expression:"add_user_show"}},[r("Form",{ref:"userAddForm",attrs:{inline:"",model:e.addUserModel,rules:e.addUserRules,"label-width":80}},[r("FormItem",{attrs:{label:"工号",prop:"workNumber"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:e.addUserModel.workNumber,callback:function(t){e.$set(e.addUserModel,"workNumber",t)},expression:"addUserModel.workNumber"}})],1),r("FormItem",{attrs:{label:"用户名称",prop:"username"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:e.addUserModel.username,callback:function(t){e.$set(e.addUserModel,"username",t)},expression:"addUserModel.username"}})],1),r("FormItem",{attrs:{label:"手机号码",prop:"mobile"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:e.addUserModel.mobile,callback:function(t){e.$set(e.addUserModel,"mobile",t)},expression:"addUserModel.mobile"}})],1),r("FormItem",{attrs:{label:"角色",prop:"role_id"}},[r("Select",{staticStyle:{width:"390px"},attrs:{multiple:""},model:{value:e.addUserModel.role_id,callback:function(t){e.$set(e.addUserModel,"role_id",t)},expression:"addUserModel.role_id"}},e._l(e.roleList,function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:e.hideAddUserModal}},[e._v("取消")]),r("Button",{attrs:{type:"primary"},on:{click:e.saveAddUser}},[e._v("确定")])],1)],1),r("Modal",{attrs:{"mask-closable":!1,title:"编辑用户"},model:{value:e.edit_user_show,callback:function(t){e.edit_user_show=t},expression:"edit_user_show"}},[r("Form",{ref:"userEditForm",attrs:{inline:"",model:e.editUserModel,rules:e.editUserRules,"label-width":80}},[r("FormItem",{attrs:{label:"工号",prop:"edit_workNumber"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:e.editUserModel.edit_workNumber,callback:function(t){e.$set(e.editUserModel,"edit_workNumber",t)},expression:"editUserModel.edit_workNumber"}})],1),r("FormItem",{attrs:{label:"用户名称",prop:"edit_username"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:e.editUserModel.edit_username,callback:function(t){e.$set(e.editUserModel,"edit_username",t)},expression:"editUserModel.edit_username"}})],1),r("FormItem",{attrs:{label:"手机号码",prop:"edit_mobile"}},[r("Input",{staticStyle:{width:"150px"},attrs:{clearable:"",disabled:""},model:{value:e.editUserModel.edit_mobile,callback:function(t){e.$set(e.editUserModel,"edit_mobile",t)},expression:"editUserModel.edit_mobile"}})],1),r("FormItem",{attrs:{label:"角色",prop:"role_id"}},[r("Select",{staticStyle:{width:"390px"},attrs:{multiple:""},model:{value:e.editUserModel.edit_role_id,callback:function(t){e.$set(e.editUserModel,"edit_role_id",t)},expression:"editUserModel.edit_role_id"}},e._l(e.roleList,function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:e.hideEditUserModal}},[e._v("取消")]),r("Button",{attrs:{type:"primary"},on:{click:e.saveEditUser}},[e._v("确定")])],1)],1)],1)},i=[],a=r("be94"),n=(r("7f7f"),r("96cf"),r("1da1")),o=r("0a21"),l={name:"user",data:function(){return{add_user_show:!1,addUserModel:{workNumber:"",username:"",mobile:"",password:"",role_id:[]},edit_user_show:!1,editUserModel:{edit_id:"",edit_workNumber:"",edit_username:"",edit_mobile:"",edit_password:"",edit_role_id:[]},addUserRules:{workNumber:[{required:!0,message:"请输入工号",trigger:"blur"}],username:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"}]},editUserRules:{edit_workNumber:[{required:!0,message:"请输入工号",trigger:"blur"}],edit_username:[{required:!0,message:"请输入姓名",trigger:"blur"}],edit_mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"}]},roleList:[],user_list:[],loading:!1,filter_keyword:"",columns:[{title:"工号",key:"workNumber",align:"center"},{title:"用户名称",key:"username",align:"center"},{title:"手机号码",key:"mobile",align:"center"},{title:"角色名称",slot:"roleName",key:"roleName",align:"center"},{title:"在职状态",slot:"inServiceStatus",key:"inServiceStatus",align:"center"},{title:"操作",slot:"action",width:260}],count:1,page:1,page_size:10,exportLoading:!1}},mounted:function(){this.getList(),this.getRoleList()},methods:{getRoleList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.role.getAllList();case 2:if(t=e.sent,r=t.err,s=t.data,!r){e.next=8;break}return this.$Message.error(r.message),e.abrupt("return");case 8:console.log(s),this.roleList=s.data.map(function(e){return{label:e.name,value:e.id}});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),saveAddUser:function(){var e=this;this.$refs["userAddForm"].validate(function(t){t?e.addUser():e.$Message.error("请按要求输入")})},Leave:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,s,i,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r={id:t.id,inServiceStatus:2},e.next=3,this.$service.user.Leave(r);case 3:if(s=e.sent,i=s.err,a=s.data,!i){e.next=9;break}return this.$Message.error(i.message),e.abrupt("return");case 9:this.$Message.success(a.message),this.getList();case 11:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),resetPassword:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,s,i,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r={id:t.id},e.next=3,this.$service.user.resetPassword(r);case 3:if(s=e.sent,i=s.err,a=s.data,!i){e.next=9;break}return this.$Message.error(i.message),e.abrupt("return");case 9:this.$Message.success(a.message);case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),addUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={workNumber:this.addUserModel.workNumber,username:this.addUserModel.username,mobile:this.addUserModel.mobile,rolelist:this.addUserModel.role_id,inServiceStatus:1},e.next=3,this.$service.user.addUser(t);case 3:if(r=e.sent,s=r.err,i=r.data,!s){e.next=9;break}return this.$Message.error(s.message),e.abrupt("return");case 9:this.$Message.success(i.message),this.add_user_show=!1,this.getList();case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),showUserModal:function(){this.add_user_show=!0},hideAddUserModal:function(){this.add_user_show=!1,this.clearAddModal()},clearAddModal:function(){this.addUserModel={workNumber:"",username:"",mobile:"",password:"",role_id:[]}},hideEditUserModal:function(){this.edit_user_show=!1,this.clearEditModal()},clearEditModal:function(){this.editUserModel={edit_workNumber:"",edit_username:"",edit_mobile:"",edit_password:"",role_id:[]}},editUser:function(e){console.log(e),this.edit_user_show=!0,this.editUserModel=Object(a["a"])({},e,{edit_workNumber:e.workNumber,edit_username:e.username,edit_mobile:e.mobile,edit_role_id:e.rl.map(function(e){return e.id})})},saveEditUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={id:this.editUserModel.id,workNumber:this.editUserModel.edit_workNumber,username:this.editUserModel.edit_username,mobile:this.editUserModel.edit_mobile,password:this.editUserModel.edit_password,rolelist:this.editUserModel.edit_role_id},console.log(t),e.next=4,this.$service.user.updateList(t);case 4:if(r=e.sent,s=r.err,i=r.data,!s){e.next=10;break}return this.$Message.error(s.message),e.abrupt("return");case 10:this.$Message.success(i.message),this.edit_user_show=!1,this.getList();case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={search:this.filter_keyword,num:this.page,size:this.page_size},this.loading=!0,e.next=4,this.$service.user.getList(t);case 4:if(r=e.sent,s=r.err,i=r.data,this.loading=!1,!s){e.next=11;break}return this.$Message.error(s.message),e.abrupt("return");case 11:console.log(i),this.user_list=i.data.list,this.count=i.data.count;case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),remove:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.user.deleteUser(t.id);case 2:if(r=e.sent,s=r.err,i=r.data,!s){e.next=8;break}return this.$Message.error(s.message),e.abrupt("return");case 8:console.log(i),this.getList();case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),changePage:function(e){this.page=e,this.getList()},changePageSize:function(e){this.page=1,this.page_size=e,this.getList()},exportExcel:function(){if(this.order_list.length){this.exportLoading=!0;var e=this.columns.map(function(e){if(e.key)return e.title}).filter(function(e){return void 0!=e}),t=this.columns.map(function(e){if(e.key)return e.key}).filter(function(e){return void 0!=e}),r=this.order_list,s={title:e,key:t,data:r,autoWidth:!0,filename:"设备列表"};o["a"].export_array_to_excel(s),this.exportLoading=!1}else this.$Message.info("表格数据不能为空！")}}},d=l,u=(r("e66f"),r("2877")),c=Object(u["a"])(d,s,i,!1,null,null,null);c.options.__file="user.vue";t["default"]=c.exports},5342:function(e,t,r){},e66f:function(e,t,r){"use strict";var s=r("5342"),i=r.n(s);i.a}}]);