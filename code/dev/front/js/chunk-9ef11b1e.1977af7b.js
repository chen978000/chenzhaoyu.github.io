(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ef11b1e"],{"0c52":function(e,t,a){},6028:function(e,t,a){"use strict";var r=a("b193"),o=a.n(r);o.a},"9a93":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{title:"标记客户地址"},model:{value:e.mapShow,callback:function(t){e.mapShow=t},expression:"mapShow"}},[a("div",{staticClass:"map_container_box"},[a("Input",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{placeholder:"请输入客户完整名称",search:"","enter-button":""},on:{"on-search":e.changeMapKeyword},model:{value:e.mapKeyword,callback:function(t){e.mapKeyword=t},expression:"mapKeyword"}}),a("baidu-map",{staticClass:"map_box",attrs:{center:e.center,zoom:15,"scroll-wheel-zoom":!0}},[a("bm-boundary",{attrs:{name:"菏泽市",strokeWeight:2,strokeColor:"blue",fillColor:"rgba(0,0,0,0)"}}),a("bm-map-type",{attrs:{"map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],anchor:"BMAP_ANCHOR_TOP_LEFT"}}),a("bm-local-search",{attrs:{keyword:e.searchKeyword,panel:!1,autoViewport:!0,location:e.searchLocation},on:{infohtmlset:e.changeMapMarket}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hide}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.selectMarket}},[e._v("确定")])],1)])},o=[],s={name:"customerMap",props:{companyName:{type:String,default:""}},watch:{mapKeyword:function(e,t){this.$emit("update:companyName",e)}},data:function(){return{mapShow:!1,center:{lng:115.479973,lat:35.23341},mapKeyword:"",searchKeyword:"",searchLocation:"菏泽",currentLocation:""}},methods:{show:function(){this.mapShow=!0,this.mapKeyword=this.companyName,this.searchKeyword=this.mapKeyword},hide:function(){this.mapShow=!1,this.currentLocation=""},changeMapMarket:function(e){console.log(e),this.currentLocation=e},changeMapKeyword:function(e){this.searchKeyword=e},selectMarket:function(){this.currentLocation?this.$emit("setLocation",this.currentLocation):this.$Message.error("请点击选定客户地址")}}},n=s,c=(a("e7b4"),a("2877")),i=Object(c["a"])(n,r,o,!1,null,"5bef249b",null);i.options.__file="customer-map.vue";t["a"]=i.exports},b193:function(e,t,a){},e7b4:function(e,t,a){"use strict";var r=a("0c52"),o=a.n(r);o.a},fc80:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main_box"},[a("span",{staticClass:"title_span"},[e._v("新增客户")]),a("div",{staticClass:"content_box"},[a("Form",{ref:"mainForm",attrs:{model:e.form_data,rules:e.customerRules,"label-position":"right","label-width":95}},[a("FormItem",{attrs:{label:"客户名称",prop:"companyName"}},[a("Input",{staticStyle:{width:"300px"},model:{value:e.form_data.companyName,callback:function(t){e.$set(e.form_data,"companyName",t)},expression:"form_data.companyName"}})],1),a("FormItem",{attrs:{label:"客户地址",prop:"address"}},[a("Input",{staticStyle:{width:"300px"},attrs:{readonly:""},on:{"on-focus":e.showMapModal},model:{value:e.form_data.address,callback:function(t){e.$set(e.form_data,"address",t)},expression:"form_data.address"}})],1),a("FormItem",{attrs:{label:"联系人",prop:"costomName"}},[a("Select",{staticStyle:{width:"300px"},attrs:{"label-in-value":""},on:{"on-change":e.changeCostomUser},model:{value:e.form_data.costomUserId,callback:function(t){e.$set(e.form_data,"costomUserId",t)},expression:"form_data.costomUserId"}},e._l(e.costomUserList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("FormItem",{attrs:{label:"联系电话",prop:"mobile"}},[a("Input",{staticStyle:{width:"300px"},model:{value:e.form_data.mobile,callback:function(t){e.$set(e.form_data,"mobile",t)},expression:"form_data.mobile"}})],1),a("FormItem",{attrs:{label:"故障响应时间",prop:"dealcycle"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.form_data.dealcycle,callback:function(t){e.$set(e.form_data,"dealcycle",t)},expression:"form_data.dealcycle"}},e._l(e.dealCycleList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("FormItem",{attrs:{label:"备注"}},[a("Input",{staticStyle:{width:"300px","font-size":"10px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请描述出现的问题"},model:{value:e.form_data.note,callback:function(t){e.$set(e.form_data,"note",t)},expression:"form_data.note"}})],1)],1),a("Button",{staticStyle:{margin:"20px"},attrs:{type:"primary"},on:{click:e.saveCustomer}},[e._v("保存")])],1),a("CustomerMap",{ref:"customerMap",attrs:{companyName:e.form_data.companyName},on:{"update:companyName":function(t){e.$set(e.form_data,"companyName",t)},setLocation:e.setLocation}})],1)},o=[],s=(a("96cf"),a("1da1")),n=a("9a93"),c=a("90de"),i={name:"index",components:{CustomerMap:n["a"]},data:function(){var e=function(e,t,a){if(!t)return a(new Error("联系电话不允许为空"));Object(c["a"])(t)||Object(c["b"])(t)?a():a("请填写手机号码或固定电话")};return{form_data:{companyName:"",costomUserId:"",costomName:"",area:"",address:"",mobile:"",note:"",dealcycle:"",currentLng:"",currentLat:""},dmlb:"",customerRules:{companyName:[{required:!0,message:"客户名称不允许为空",trigger:"blur"}],address:[{required:!0,message:"客户地址不允许为空",trigger:"change"}],costomName:[{required:!0,message:"联系人不允许为空",trigger:"blur"}],mobile:[{required:!0,validator:e,trigger:"blur"}],dealcycle:[{required:!0,message:"请选择故障响应时间",trigger:"change"}]},dealCycleList:[],costomUserList:[]}},watch:{"form_data.companyName":{handler:function(e){e&&" "!=e||(this.form_data.address="")},deep:!0}},mounted:function(){this.getDealCycleList(),this.getCustomUserList()},methods:{saveCustomer:function(){var e=this;this.$refs["mainForm"].validate(function(t){t?e.addCustomer():e.$Message.error("请按要求输入")})},getCustomUserList:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={level:"costom"},e.next=3,this.$service.user.getListAll(t);case 3:if(a=e.sent,r=a.err,o=a.data,!r){e.next=9;break}return this.$Message.error(r.message),e.abrupt("return");case 9:this.costomUserList=o.data;case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),changeCostomUser:function(e){console.log(e)},addCustomer:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={companyName:this.form_data.companyName,address:this.form_data.address,costomName:this.form_data.costomName,costomId:this.form_data.costomUserId,mobile:this.form_data.mobile,note:this.form_data.note,area:this.form_data.area,addressX:this.form_data.currentLat,addressY:this.form_data.currentLng,dealcycle:this.form_data.dealcycle},e.next=3,this.$service.customer.addCustomer(t);case 3:if(a=e.sent,r=a.err,o=a.data,!r){e.next=9;break}return this.$Message.error(r.message),e.abrupt("return");case 9:this.$Message.success(o.message),this.$router.push({name:"customer_list"});case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),goToAddDevice:function(){this.$router.push("/device/add_device")},showMapModal:function(){this.form_data.companyName.length<2?this.$Message.error("请输入客户完整名称"):this.$refs["customerMap"].show()},setLocation:function(e){this.form_data.currentLng=e.point.lng,this.form_data.currentLat=e.point.lat,this.form_data.address=e.address,e.province&&e.city&&(this.form_data.area="".concat(e.province).concat(e.city)),this.$refs["customerMap"].hide()},getDealCycleList:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={dmlb:"dealcycle"},e.next=3,this.$service.order.getServer(t);case 3:if(a=e.sent,r=a.err,o=a.data,!r){e.next=9;break}return this.$Message.error(r.message),e.abrupt("return");case 9:this.dealCycleList=o.data.map(function(e){return{value:e.dmz,label:e.dmsm1}});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},m=i,l=(a("6028"),a("2877")),u=Object(l["a"])(m,r,o,!1,null,"13f70eee",null);u.options.__file="add_customer.vue";t["default"]=u.exports}}]);