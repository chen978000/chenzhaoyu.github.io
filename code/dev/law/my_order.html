<!DOCTYPE html>
<html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<meta name="keywords" content="" /> 
<meta name="description" content="">
<link rel="stylesheet" type="text/css" href="font/iconfont.css">
<link type="text/css" rel="stylesheet" href="css/public.css" />
<link type="text/css" rel="stylesheet" href="css/index.css" />

<script src="js/jquery.js" type="text/javascript"></script>
<!--<script src="js/my.js" type="text/javascript"></script>-->
	<!-- 引入样式 -->
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<script src="js/vue.js" type="text/javascript"></script>
	<script src="js/util.js" type="text/javascript"></script>
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>

	<title>我的订单</title>
<body>
<div id="app">
  <header class="other_header">
    <div class="head_box">
      <a href="javascript:void(0);" onclick="goBack()" class="head_left"><i class="iconfont">&#xe6d9;</i></a>
      <span>我的订单</span>
      <a href="" class="head_right"></a>
    </div>
  </header>
  <section>
    <div class="my_order">
      <ul>
        <li v-for="item in list">
          <h2>乙方：{{item.key_property.party_name_b}} <i class="iconfont">&#xe617;</i><span>未支付</span></h2>
          <h1>科技劳动合同(模拟接口无) <span>￥{{item.price || 0}}<i>元</i></span></h1>
          <p>编号：{{item.session_id.substring(item.session_id.length-12)}}</p>
          <p>签署日期：{{item.modified_date_time.slice(0,10)}} {{item.modified_date_time.slice(11,19)}}</p>
          <!--<div class="order_button">-->
            <!--<a href="javascript:void(0);" class="one">取消合同</a>-->
            <!--<a href="sure_order.html" class="two">支付</a>-->
          <!--</div>-->
          <div style="text-align: right;margin-top: 5px">
            <el-button round size="mini" style="margin-right: 10px;display: inline-block">取消合同</el-button>
            <el-button size="mini" type="danger" round style="display: inline-block">支付</el-button>
          </div>
        </li>
        <!--<li>-->
          <!--<h2>乙方：马云 <i class="iconfont">&#xe617;</i><span>未支付</span></h2>-->
          <!--<h1>科技劳动合同 <span>￥9.9<i>元</i></span></h1>-->
          <!--<p>编号：123145646465</p>-->
          <!--<p>签署日期：2018-07-23</p>-->
          <!--<div class="order_button">-->
            <!--<a href="javascript:void(0);" class="one">取消合同</a>-->
            <!--<a href="sure_order.html" class="two">支付</a>-->
          <!--</div>-->
        <!--</li>-->
        <!--<li>-->
          <!--<h2>乙方：马云 <i class="iconfont">&#xe617;</i><span>未支付</span></h2>-->
          <!--<h1>科技劳动合同 <span>￥9.9<i>元</i></span></h1>-->
          <!--<p>编号：123145646465</p>-->
          <!--<p>签署日期：2018-07-23</p>-->
          <!--<div class="order_button">-->
            <!--<a href="javascript:void(0);" class="one">取消合同</a>-->
            <!--<a href="sure_order.html" class="two">支付</a>-->
          <!--</div>-->
        <!--</li>-->
      </ul>
    </div>
  </section>
</div>
<div class="order_popup">
	<h1>确认取消订单？</h1>
	<div class="order_anniu">
		<a class="one" href="javascript:void(0);">确认</a>
		<a class="two" href="javascript:void(0);">取消</a>
	</div>
</div>
<script>
  new Vue({
    el: '#app',
    data(){
      return {
        loading: false,
        xid: '',
        list: []
      }
    },
    mounted(){
      this.getId()
      this.getList()
    },
    methods:{
      // 判断是否有xid
      getId(){
        const that = this
        that.xid = sessionStorage.getItem('xid')
        if(!that.xid){
          that.$message.error('未知用户，请重新登录')
          setTimeout(()=>{
            window.location = './login.html'
          },1500)
        }
      },
      // 获取合同列表
      getList(){
        const that = this
        that.loading = true
        network({
          params: {
            "state": 'complete'
          },
          path: `session`,
          method: 'get',
          head: [
            "Content-Type: application/json",
            `X-DC-UID: ${that.xid}`
          ],
          success: function (e) {
            that.loading = false
            const data = JSON.parse(e);
            // console.log(data)
            let arr = data.sessions
            that.count = data.count
            that.list = arr.map(item=>{
              let a = item
              if(item.key_property){
                let b = JSON.parse(item.key_property)
                a.key_property = b
              }
              return a
            }).filter(item=>item.key_property)
            console.log(that.list)
          }
        })
      },

    }
  })

</script>
</body>
</html>