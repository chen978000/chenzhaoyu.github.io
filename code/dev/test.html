{extend name="base/common"/} {block name="style"}
<!--<link href="__CSS__/mui.picker.min.css" rel="stylesheet" />-->
<!--<link rel="stylesheet" href="__CSS__/PersonalCenter/PersonalCenter.css" />-->
<!--<link rel="stylesheet" href="__CSS__/ydui.css" />-->


<link rel="stylesheet" href="https://m.huibojob.com/static/css/wap/mui.min.css">
<link rel="stylesheet" href="https://m.huibojob.com/static/css/wap/global.css">
<link rel="stylesheet" href="https://m.huibojob.com/static/css/wap/mui.picker.min.css">
<link rel="stylesheet" href="https://m.huibojob.com/static/css/wap/PersonalCenter/PersonalCenter.css">
<link rel="stylesheet" href="https://m.huibojob.com/static/css/wap/ydui.css">
<link rel="stylesheet" href="https://m.huibojob.com/static/font/iconfont_wap/iconfont.css">

<!-- 引入样式文件 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.2/lib/index.css">

<!-- 引入 Vue 和 Vant 的 JS 文件 -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vant@2.2/lib/vant.min.js"></script>

<script src="https://m.huibojob.com/static/script/wap/jquery-1.12.4.min.js"></script>
<script src="https://m.huibojob.com/static/script/wap/mui.min.js"></script>
<script src="https://m.huibojob.com/static/script/wap/rem.js"></script>
<script src="https://zz.bdstatic.com/linksubmit/push.js"></script>
<script src="https://m.huibojob.com/static/script/wap/personalcenter/index.js"></script>
<script src="https://m.huibojob.com/static/script/wap/city/ydui.js"></script>
<script src="https://m.huibojob.com/static/script/wap/mui.picker.min.js"></script>
<style>
  body {
    height: 100vh !important;
  }
  [v-cloak]{
    display: none;
  }
  .item_box{
    width: 100%;
    height: 80px;
    line-height: 80px;
    text-align: center;
    border-bottom: 2px solid #ccc;
  }
</style>
{/block} {block name="header"}
<header class="mui-bar mui-bar-nav nav-top">
  <a class="mui-action-back iconfont icon-fanhui mui-pull-left"></a>
  <h1 class="mui-title">注册简历</h1>
</header>

{/block} {block name="main"}
<div id="app" v-cloak>
  <p class="reg-p">基本信息<span></span></p>
  <form class="lr-box" id="form" style="height:100vh;overflow-y: auto;">
    <ul class="mui-from-box">
      <li>
        <p>真实姓名</p>
        <a href="javascript:;"><input type="text" id="name" name="user_name" placeholder="如：汇小伯" class="mui-input"/></a>
      </li>
      <li>
        <p>手机号码</p>
        <a href="javascript:;"><input type="tel" name="user_mobile" id="tel" placeholder="请填写手机号码" class="mui-input"
                                      value="{$userinfo.user_mobile}"/></a>
      </li>
      <li>
        <p>性别</p>
        <input @click="showSex" type="text" v-model="user_sex_text" placeholder="如：男" class="mui-input" readonly/>
        <input type="text" hidden name="user_sex" class="user_sex" v-model="user_sex">
        <van-popup position="bottom" v-model="sexShow">
          <div style="width: 100%;background: #fff;">
            <div class="item_box" @click="setSex(1)">男</div>
            <div class="item_box" @click="setSex(2)">女</div>
            <div class="item_box" @click="sexShow=false">取消</div>
          </div>
        </van-popup>
      </li>
      <!--<div class="my_bottom_box">-->
      <!--<div>男</div>-->
      <!--<div>女</div>-->
      <!--<div>取消</div>-->
      <!--</div>-->
      <!--<div id="sex" class="mui-popover mui-popover-action mui-popover-bottom" style="z-index: 9">-->
      <!--<ul class="mui-table-view">-->
      <!--<li class="mui-table-view-cell">-->
      <!--<a href="javascript:;" data-value="1" >男</a>-->
      <!--</li>-->
      <!--<li class="mui-table-view-cell">-->
      <!--<a href="javascript:;" data-value="2">女</a>-->
      <!--</li>-->
      <!--</ul>-->
      <!--<ul class="mui-table-view">-->
      <!--<li class="mui-table-view-cell">-->
      <!--<a href="#forward">取消</a>-->
      <!--</li>-->
      <!--</ul>-->
      <!--</div>-->
      <li>
        <p>出生日期</p>
        <a href="javascript:;" id="user_birthday" data-id="birthday"
           data-options='{"type":"date","beginYear":1949,"endYear":2003}'><input type="text" name="user_birthday"
                                                                                 placeholder="请选择出生日期" class="mui-input"
                                                                                 readonly/></a>
      </li>
      <li>
        <p>婚姻状况</p>
        <input @click="marryShow=true" v-model="marry_text" type="text" placeholder="如：保密" class="mui-input" readonly/>
        <input type="hidden" v-model="marry" name="user_marry" class="user_marry"/>
        <van-popup position="bottom" v-model="marryShow">
          <div style="width: 100%;background: #fff;">
            <div class="item_box" @click="setMarry(1)">已婚</div>
            <div class="item_box" @click="setMarry(0)">未婚</div>
            <div class="item_box" @click="setMarry(3)">保密</div>
            <div class="item_box" @click="marryShow=false">取消</div>
          </div>
        </van-popup>
      </li>
      <!--<div id="user_marry" class="mui-popover mui-popover-action mui-popover-bottom">-->
        <!--<ul class="mui-table-view">-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="javascript:;" data-value="1">已婚</a>-->
          <!--</li>-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="javascript:;" data-value="0">未婚</a>-->
          <!--</li>-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="javascript:;" data-value="3">保密</a>-->
          <!--</li>-->
        <!--</ul>-->
        <!--<ul class="mui-table-view">-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="#forward">取消</a>-->
          <!--</li>-->
        <!--</ul>-->
      <!--</div>-->
      <li>
        <p>现居住地</p>
        <!--data-idname唯一标识    data-n联动数     data-id 1为地区选择  2为职位选择  data-maxlength做多可选择数-->
        <a href="javascript:;" class="J_Address" data-idname="qiwang" data-n="4" data-id="1" data-maxlength="1"><input
                type="text" placeholder="请选择居住地" class="mui-input" readonly/><input type="hidden" id=""
                                                                                    value="{present name="
                                                                                    resumebaseinfo.city_id"}{$resumebaseinfo['city_id']}{/present}"
          name="city_id" /></a>
      </li>
      <li>
        <p>工作经验</p>
        <input @click="expShow=true" v-model="exp_text" type="text" placeholder="如：保密" class="mui-input" readonly/>
        <input type="hidden" v-model="exp_id" name="experience_id" class="experience_id"/>
        <van-popup position="bottom" v-model="expShow">
          <div style="width: 100%;background: #fff;">
            <!--{volist name="$Think.config.system.site_experience" id="vo"}-->
            <!--<div class="item_box" @click="setExp({$vo.experience_id},{$vo.experience_name})">{$vo.experience_name}</div>-->
            <!--{/volist}-->
          </div>
        </van-popup>
        <!--<a href="#experience_id"><input type="text" placeholder="请选择工作经验" class="mui-input" readonly/><input type="hidden"-->
                                                                                                             <!--name="experience_id"-->
                                                                                                             <!--id=""/></a>-->
      </li>
      <!--<div id="experience_id" class="mui-popover mui-popover-action mui-popover-bottom">-->
        <!--<ul class="mui-table-view">-->
          <!--{volist name="$Think.config.system.site_experience" id="vo"}-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="javascript:;" data-value="{$vo.experience_id}">{$vo.experience_name}</a>-->
          <!--</li>-->
          <!--{/volist}-->

        <!--</ul>-->
        <!--<ul class="mui-table-view">-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="#forward">取消</a>-->
          <!--</li>-->
        <!--</ul>-->
      <!--</div>-->
      <li>
        <p>最高学历</p>
        <input @click="xueShow=true" v-model="xue_text" type="text" placeholder="如：保密" class="mui-input" readonly/>
        <input type="hidden" v-model="xue_id" name="educational_id" class="educational_id"/>
        <van-popup position="bottom" v-model="xueShow">
          <div style="width: 100%;background: #fff;">
            {volist name="$Think.config.system.site_edu" id="vo"}
            <!--<div class="item_box" @click="setXue({$vo.educational_id},{$vo.educational_name})">{$vo.educational_name}</div>-->
            {/volist}
          </div>
        </van-popup>
        <!--<a href="#xueli"><input type="text" placeholder="请选择学历" class="mui-input" readonly/><input type="hidden"-->
                                                                                                   <!--name="educational_id"-->
                                                                                                   <!--id=""/></a>-->
      </li>
      <!--<div id="xueli" class="mui-popover mui-popover-action mui-popover-bottom">-->
        <!--<ul class="mui-table-view">-->
          <!--{volist name="$Think.config.system.site_edu" id="vo"}-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="javascript:;" data-value="{$vo.educational_id}">{$vo.educational_name}</a>-->
          <!--</li>-->
          <!--{/volist}-->
        <!--</ul>-->
        <!--<ul class="mui-table-view">-->
          <!--<li class="mui-table-view-cell">-->
            <!--<a href="#forward">取消</a>-->
          <!--</li>-->
        <!--</ul>-->
      <!--</div>-->
      <li>
        <p>自我评价</p>
        <textarea rows="5" name="user_introduce" placeholder="自我评价"></textarea>
      </li>
    </ul>
    <p class="reg-p">求职期望</p>
    <ul class="mui-from-box">
      <li>
        <p>求职状态</p>
        <a href="#status_zhuangtai"><input type="text" placeholder="如：离职，随时到岗" class="mui-input" readonly/><input
                type="hidden" name="status_id" id=""/></a>
      </li>
      <div id="status_zhuangtai" class="mui-popover mui-popover-action mui-popover-bottom">
        <ul class="mui-table-view">
          <li class="mui-table-view-cell">
            <a href="javascript:;" data-value="0">请选择求职状态</a>
          </li>
          {volist name="Think.config.system.site_resumestatus" id="vo"}
          <li class="mui-table-view-cell">
            <a href="javascript:;" data-value="{$vo.status_id}">{$vo.status_name}</a>
          </li>
          {/volist}
        </ul>
        <ul class="mui-table-view">
          <li class="mui-table-view-cell">
            <a href="#forward">取消</a>
          </li>
        </ul>
      </div>

      <li>
        <p>期望行业</p>
        <a href="javascript:;" data-id="hangye" class="open-checkbox"><input type="text" placeholder="请选择"
                                                                             class="mui-input" readonly
                                                                             name="intention_json_data[intention_profession]"/><input
                name="profession_id" type="hidden" id=""/><span></span></a>
      </li>
      <div class="hangye-list" id="hangye">
        <div class="mui-card">
          <div class="mui-input-group">

            {volist name="Think.config.system.site_all_profession" id="vo"}
            <div class="mui-input-row mui-checkbox mui-left">
              <label>{$vo.profession_name}
                <input name="checkbox1" value="{$vo.profession_id}" type="checkbox">
              </label>
            </div>
            {/volist}

          </div>
        </div>
        <div class="job_tab_filter3-btn clearfix">
          <input type="reset" class="" value="重 置"/>
          <input type="button" class="" value="提 交"/>
        </div>
      </div>

      <li>
        <p>求职意向</p>
        <!--data-idname唯一标识    data-n联动数     data-id 1为地区选择  2为职位选择  data-maxlength做多可选择数-->
        <a href="javascript:;" class="J_Address" data-idname="yixiang" data-n="3" data-id="2" data-maxlength="5"><input
                type="text" name="intention_json_data[job_class_name]" placeholder="请选择求职意向" class="mui-input"
                readonly/><input name="job_classid" type="hidden" id=""/></a>
      </li>
      <li>
        <p>工作性质</p>
        <a href="#xingzhi"><input type="text" placeholder="如：全职" class="mui-input" readonly/><input name="job_typeid"
                                                                                                    type="hidden" id=""/></a>
      </li>
      <div id="xingzhi" class="mui-popover mui-popover-action mui-popover-bottom">

        <ul class="mui-table-view">
          <li class="mui-table-view-cell">
            <a href="javascript:;" data-value="0">不限</a>
          </li>
          {volist name="Think.config.system.site_jobtype" id="vo"}
          <li class="mui-table-view-cell">
            <a href="javascript:;" data-value="{$vo.type_id}">{$vo.type_name}</a>
          </li>
          {/volist}
        </ul>
        <ul class="mui-table-view">
          <li class="mui-table-view-cell">
            <a href="#forward">取消</a>
          </li>
        </ul>
      </div>
      <li>
        <p>期望薪资</p>
        <a href="#showUserPicker"><input type="text" placeholder="如：5000-8000" class="mui-input" readonly/><input
                type="hidden" name="salary_id" id=""/></a>
      </li>
      <div id="showUserPicker" class="mui-popover mui-popover-action mui-popover-bottom">
        <ul class="mui-table-view">
          {volist name="Think.config.system.site_salary" id="vo"}
          <li class="mui-table-view-cell">
            <a href="javascript:;" data-value="{$vo.salary_id}">{$vo.salary_name}</a>
          </li>
          {/volist}
        </ul>
        <ul class="mui-table-view">
          <li class="mui-table-view-cell">
            <a href="#forward">取消</a>
          </li>
        </ul>
      </div>
      <li>
        <p>福利待遇</p>
        <a href="javascript:;" data-id="fuli" class="open-checkbox"><input type="text" placeholder="请选择" class="mui-input"
                                                                           readonly/><input name="job_tagid" type="hidden"
                                                                                            id=""/><span></span></a>
      </li>
      <div class="job_tab_filter3" id="fuli">
        <div class="mui-input-group">
          <div class="mui-card">
            {volist name="Think.config.system.site_jobtag" id="vo"}
            <div class="mui-checkbox">
              <label>
                <input value="{$vo.tag_id}" type="checkbox">
                <span>{$vo.tag_name}</span>
              </label>
            </div>
            {/volist}

          </div>
        </div>
        <div class="job_tab_filter3-btn clearfix">
          <input type="reset" class="" value="重 置"/>
          <input type="button" class="" value="提 交"/>
        </div>
      </div>
      <li>
        <p>意向地区</p>
        <!--data-idname唯一标识    data-n联动数     data-id 1为地区选择  2为职位选择  data-maxlength做多可选择数-->
        <a href="javascript:;" class="J_Address" data-idname="diqu" data-n="4" data-id="1" data-maxlength="5"><input
                type="text" name="intention_json_data[intention_city_name]" placeholder="请选择意向地区" class="mui-input"
                readonly/><input type="hidden" name="intention_cityid" id=""/></a>
      </li>

    </ul>


  </form>
  <div class="btn-box">
    <button type="button" class="mui-btn mui-btn-danger mui-btn-block" id="subBtn">生成简历</button>
  </div>
</div>

{/block} {block name="script"}


<!--<script src="./personalcenter/index.js"></script>-->
<!--<script src="./city/ydui.js"></script>-->
<!--<script src="mui.picker.min.js"></script>-->
<script>

  $(function () {

    $(".reg-p span").html($("#form").height());

    var city = new LightBox();
    $("#subBtn").click(function () {
      console.log($('.user_sex').val())

      var i = 0;
      $(".mui-from-box li input").each(function () {
        var hval = $(this).val();
        if (!hval || hval.trim() == "") {
          $(this).parent().prev().addClass("error");
          i++;
        } else {
          $(this).parent().prev().removeClass("error");
        }
      })
      var myreg = /^[1][3,4,5,6,7,8,9][0-9]{9}$/;
      var verifyname = $('#name');
      var verifyEmail = $('#tel');
      if (!myreg.exec(verifyEmail.val())) {
        mui.alert("手机号格式不正确");
        $("#tel").addClass("error");
        return false;
      }
      if (i > 0) {
        mui.alert("请把您的简历填写完整，以便于找到合适的工作！")
      } else {
        //提交简历
        $.ajax({
          url: wap_domain + "/save_register_resume.html",
          data: $("#form").serialize(),
          method: "POST",
          dataType: "json",
          crossDomain: true,
          beforeSend: function () {
            // 禁用按钮防止重复提交，发送前响应
            $("#subBtn").attr("disabled", "disabled").val('处理中，请稍候...');
          },
          success: function (res) {

            if (res.status === 1) {
              mui.toast("简历创建成功,正在跳转中");
              $("#subBtn").val("简历创建成功,正在跳转中...");
              setTimeout(function () {
                location.href = wap_domain + "/register_resume_face.html";
              }, 1000);
            } else {
              mui.toast(res.message);
              setTimeout(function () {
                $("#subBtn").removeAttr("disabled").val('生成简历');
              }, 1000);

            }
          },
          error: function (data) {
            mui.toast("简历生成失败，请重试");
            $("#subBtn").removeAttr("disabled").val('生成简历');
          }
        });
        return false;
      }

    })
  })
</script>
<script>
  const expList = $Think.config.system.site_experience
  const xueList = $Think.config.system.site_edu

  new Vue({
    el:'#app',
    data(){
      return{
        expList: expList,
        xueList: xueList,


        sexShow: false,
        user_sex: '',
        user_sex_text: '',

        marryShow: false,
        marry: '',
        marry_text: '',

        expShow: false,
        exp_id: '',
        exp_text: '',

        xueShow: false,
        xue_id: '',
        xue_text: ''
      }
    },
    mounted(){
      console.log(this.xueList)
      console.log(this.expList)
    },
    methods: {
      showSex(){
        this.sexShow = true
      },
      setSex(e){
        this.user_sex = e;
        this.user_sex_text = e==1?'男':'女';
        this.sexShow = false
        console.log($('.user_sex'))
      },
      setMarry(e){
        this.marry = e;
        this.marry_text = e==1?'已婚':e==0?'未婚':'保密';
        this.marryShow = false
      },
      setExp(value,text){
        this.exp_id = value;
        this.exp_text = text;
        this.expShow = false
      },
      setXue(value,text){
        this.xue_id = value;
        this.xue_text = text;
        this.xueShow = false
      },
    }
  });
</script>
{/block}